@inject IJSRuntime JSRuntime

<button class="theme-toggle-formal" @onclick="ToggleTheme" title="Alternar modo oscuro">
    <div class="toggle-track @(IsDarkMode ? "dark" : "")">
        <div class="toggle-thumb"></div>
    </div>
</button>

<style>
    .theme-toggle-formal {
        background: none;
        border: none;
        padding: 5px;
        cursor: pointer;
        outline: none;
    }

    .theme-toggle-formal .toggle-track {
        width: 44px;
        height: 24px;
        background-color: #cbd5e1; /* Light gray */
        border-radius: 99px;
        position: relative;
        transition: background-color 0.3s ease;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    }

    .theme-toggle-formal .toggle-track.dark {
        background-color: #4ade80; /* Primary Green or a dark accent */
    }

    .theme-toggle-formal .toggle-thumb {
        width: 18px;
        height: 18px;
        background-color: white;
        border-radius: 50%;
        position: absolute;
        top: 3px;
        left: 3px;
        transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .theme-toggle-formal .toggle-track.dark .toggle-thumb {
        transform: translateX(20px);
    }
</style>

@code {
    private bool IsDarkMode { get; set; } = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            IsDarkMode = await JSRuntime.InvokeAsync<bool>("themeManager.isDarkMode");
            StateHasChanged();
        }
    }

    private async Task ToggleTheme()
    {
        IsDarkMode = !IsDarkMode;
        await JSRuntime.InvokeVoidAsync("themeManager.setTheme", IsDarkMode);
    }
}
